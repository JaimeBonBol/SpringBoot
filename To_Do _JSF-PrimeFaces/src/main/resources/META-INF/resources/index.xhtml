<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <title>To Do List</title>
</h:head>
<h:body>
    <h1>Mi To-Do List</h1>

    <h:form id="form">
        <p:panel header="Agregar nueva tarea">
            <p:panelGrid columns="2">
                <h:outputLabel value="Título:" />
                <p:inputText value="#{indexController.newTask.title}" required="true" />

                <h:outputLabel value="Descripción:" />
                <p:inputTextarea value="#{indexController.newTask.description}" />

                <h:outputLabel value="Fecha límite:" />
                <p:datePicker value="#{indexController.newTask.dueDate}" pattern="yyyy-MM-dd" />
            </p:panelGrid>
            <p:commandButton value="Agregar" action="#{indexController.addTask}" update=":form:pendientes :form:completadas" />
        </p:panel>

        <br />

        <p:panel header="Tareas Pendientes">
            <p:dataTable id="pendientes" value="#{indexController.pendingTasks}" var="task">
                <p:column headerText="Título">
                    <h:outputText value="#{task.title}" />
                </p:column>
                <p:column headerText="Descripción">
                    <h:outputText value="#{task.description}" />
                </p:column>
                <p:column headerText="Fecha límite">
                    <h:outputText value="#{task.dueDate}" />
                </p:column>
                <p:column headerText="Acciones">
                    <p:commandButton icon="pi pi-check"
                                     action="#{indexController.completeTask}"
                                     update=":form:pendientes :form:completadas">
                        <f:setPropertyActionListener value="#{task}" target="#{indexController.taskSelected}" />
                    </p:commandButton>

                    <p:commandButton icon="pi pi-trash"
                                     action="#{indexController.deleteTask}"
                                     update=":form:pendientes">
                        <f:setPropertyActionListener value="#{task}" target="#{indexController.taskSelected}" />
                    </p:commandButton>

                </p:column>
            </p:dataTable>
        </p:panel>

        <br />

        <p:panel header="Tareas Completadas">
            <p:dataTable id="completadas" value="#{indexController.completedTasks}" var="task">
                <p:column headerText="Título">
                    <h:outputText value="#{task.title}" style="text-decoration: line-through;" />
                </p:column>
                <p:column headerText="Descripción">
                    <h:outputText value="#{task.description}" style="text-decoration: line-through;" />
                </p:column>
                <p:column headerText="Fecha límite">
                    <h:outputText value="#{task.dueDate}" />
                </p:column>
                <p:column headerText="Acciones">
                    <p:commandButton icon="pi pi-trash" action="#{indexController.deleteTask}" update=":form:completadas :form:pendientes">
                        <f:setPropertyActionListener value="#{task}" target="#{indexController.taskSelected}" />
                    </p:commandButton>
                </p:column>

            </p:dataTable>
        </p:panel>
    </h:form>
</h:body>
</html>
